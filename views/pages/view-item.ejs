<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- BOOTSTRAP CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<!-- for latest compiled and minified CSS -->
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- for jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- for latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

	
<!-- for date picker -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

<!-- for leflet.js (map)-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
crossorigin=""></script>

<!-- favicon -->
<link rel="shortcut icon" href="/views/images/favlogo.ico" type="image/x-icon">
<link rel="icon" href="/views/images/favlogo.ico" type="image/x-icon">
    <title>Mang Hiram</title>
   <link rel="stylesheet" href="/assets/view-item.css">
</head>
<body>
    
  <!-- Navbar -->
  <%- include ('navbar') -%>
      
      <div class="container d-flex justify-content-center mt-50 mb-50 ms-10">
		<div class="main">
        <div class="row">
            <div class="column">
                <div class="polaroid">
                  <img src="<%= rows[0].image_path %>" alt="" style="width:100%">
                      <div class="p-container"></div>
                  </div>

                  <h4 style="font-weight: bold;">Description:</h4>
             
                  <div class="desc" style="font: weight 1px; color: darkslategrey;"><%= rows[0].item_description %></div>
                      <!-- line separator -->
                    <hr style="height:2px;border-width:0;color:gray;background-color:gray">
                      
                       <!-- di ko sure kung i-div ko to o ok lang na naka <p> -->
                    <p style="font-weight: bold;">Rental fee: <%= rows[0].rate %><br>
                        Deposit fee:<br>
                        Size:<br>
                         Branch:
                     </p>
    
                </div>
                <!----- 2nd column ------>
                  <div class="column">
                    <h3 style="text-align: center;"><%= rows[0].item_name %></h3>
                  <div class="box1">
                   <!-- <label for="start">Start date:</label>
                     <input type="date" id="start" name="date-start"
                           value="2018-07-22"
                           min="2022-01-01" max="2024-12-31">
                           <label for="start">End date:</label>
                     <input type="date" id="end" name="date-end"
                           value="2018-07-22"
                           min="2022-01-01" max="2024-12-31"> -->
			  
			            <div class='col-md-5'>
                    <form id="check_avail" method="post" action="/items/view/1">
                      <h4>Choose dates</h4>
                      <input type="text" id="daterange" name="daterange"/>
                                          
                      <button type="submit" class="btn-availability">Check Availability</button>
                    </form>                    
                 	</div>
			  
                            
              </div>
  <!-- ---- MAP ----- -->
              <br>
              <p>Location</p>
              <div id="map">

              </div>

              <br>
              <h4>Item owned by <%= rows[0].seller %></h4>
              <a target="_blank" href="/profile/<%= rows[0].seller %>">
               <img class="img2" src="/images/profile.png" alt="profile" style="width:100px"> </a>
               <!-- CSS STAR RATING -->
                   <span class="fa fa-star checked"></span>
                   <span class="fa fa-star checked"></span>
                   <span class="fa fa-star checked"></span>
                   <span class="fa fa-star"></span>
                   <span class="fa fa-star"></span>
               <!--  //  -->
                   <br>
                   <br>
               <button class="btn-message">Message</button>
               <a href="/profile/<%= rows[0].seller %>"><button class="btn-profile">See Profile</button></a>
               
               </div>
             </div>
             </div>
         </div>
   </body>

   <script>
      var dateToday = new Date();      
      $(function() {
        $('input[name="daterange"]').daterangepicker({
          opens: 'left',
          minDate: dateToday,

          //for invalid dates
          isInvalidDate: function(date) {
            var dateRanges = [];                                 

              <% result.forEach(function(reserved){ %>
                dateRanges.push({ 'start': moment('<%= reserved.start %>'), 'end': moment('<%= reserved.end %>') })
              <% }) %>
                
            return dateRanges.reduce(function(bool, range) {
                return bool || (date >= range.start && date <= range.end);
            }, false);
        }
    },
        function(start, end, label) {
          console.log("date: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
          
          });
      });

      
      var map = L.map('map').setView([14.601, 121.0151], 17);
       L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
       maxZoom: 19,
       attribution: 'Â© OpenStreetMap'
      }).addTo(map);
      var marker = L.marker([14.601, 121.0151]).addTo(map);
   </script>
</html>
